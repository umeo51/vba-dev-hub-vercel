# Googleフォーム作成・設定手順書

## 📋 概要

VBA Dev Hubのお問い合わせページにGoogleフォームを埋め込むための手順書です。

## 🎯 目的

- ユーザーからの問い合わせを受け付ける
- 問い合わせ内容をGoogleスプレッドシートに自動保存
- メール通知を受け取る（オプション）

## 📝 手順

### ステップ1: Googleフォームの作成

1. **Googleフォームにアクセス**
   - https://forms.google.com/ を開く
   - Googleアカウントでログイン

2. **新しいフォームを作成**
   - 「空白」を選択
   - または「+」ボタンをクリック

3. **フォームのタイトルを設定**
   - タイトル: `VBA Dev Hub - お問い合わせフォーム`
   - 説明: `VBA Dev Hubに関するご質問、ご意見、ご要望などをお聞かせください。`

### ステップ2: 質問の追加

以下の質問を順番に追加してください。

#### 質問1: お名前

- **質問タイプ**: 記述式
- **質問**: `お名前`
- **必須**: ✅ オン
- **説明**: （なし）

#### 質問2: メールアドレス

- **質問タイプ**: 記述式
- **質問**: `メールアドレス`
- **必須**: ✅ オン
- **回答の検証**: 
  - 「数値」→「テキスト」→「メールアドレス」を選択
  - エラーテキスト: `有効なメールアドレスを入力してください`

#### 質問3: 件名

- **質問タイプ**: プルダウン
- **質問**: `件名`
- **必須**: ✅ オン
- **選択肢**:
  1. 一般的なお問い合わせ
  2. バグ報告
  3. 機能要望
  4. コンテンツに関するお問い合わせ
  5. その他

#### 質問4: お問い合わせ内容

- **質問タイプ**: 段落
- **質問**: `お問い合わせ内容`
- **必須**: ✅ オン
- **説明**: `できるだけ詳しくご記入ください。バグ報告の場合は、再現手順やエラーメッセージもお知らせください。`

### ステップ3: フォームのデザイン設定

1. **テーマのカスタマイズ**（右上のパレットアイコンをクリック）
   - **テーマの色**: 紫色（#9333EA）を選択
   - **背景色**: 白
   - **フォントスタイル**: Basic

2. **設定の調整**（右上の歯車アイコンをクリック）
   - **全般**タブ:
     - ✅ メールアドレスを収集する: オフ（既に質問として追加済み）
     - ✅ 回答を1回に制限する: オフ
     - ✅ 回答を編集する: オフ
   - **プレゼンテーション**タブ:
     - ✅ 進行状況バーを表示: オン
     - ✅ 質問の順序をシャッフルする: オフ
     - **確認メッセージ**: `お問い合わせありがとうございます。2〜3営業日以内にご返信いたします。`

### ステップ4: 埋め込みコードの取得

1. **「送信」ボタンをクリック**
   - フォーム編集画面の右上にある「送信」ボタンをクリック

2. **埋め込みタブを選択**
   - ダイアログが開いたら、「<>」（埋め込み）タブをクリック

3. **iframeコードをコピー**
   - 表示されたHTMLコード全体をコピー
   - 例:
     ```html
     <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSc.../viewform?embedded=true" width="640" height="800" frameborder="0" marginheight="0" marginwidth="0">読み込んでいます…</iframe>
     ```

4. **URLのみを抽出**
   - `src="..."`の中のURLのみを抽出
   - 例: `https://docs.google.com/forms/d/e/1FAIpQLSc.../viewform?embedded=true`

### ステップ5: サイトへの埋め込み

1. **ファイルを開く**
   - `app/contact/page.tsx`を開く

2. **URLを置き換え**
   - 以下の行を見つける:
     ```typescript
     const GOOGLE_FORM_URL = "https://docs.google.com/forms/d/e/YOUR_FORM_ID/viewform?embedded=true";
     ```
   - `YOUR_FORM_ID`の部分を、ステップ4で取得したURLに置き換える
   - 例:
     ```typescript
     const GOOGLE_FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSc.../viewform?embedded=true";
     ```

3. **保存してデプロイ**
   - ファイルを保存
   - Gitにコミット&プッシュ
   - Vercelで自動デプロイが開始される

### ステップ6: 回答の確認設定

1. **回答を表示**
   - Googleフォームの編集画面で「回答」タブをクリック

2. **スプレッドシートにリンク**（推奨）
   - 「回答」タブの右上にある緑色のスプレッドシートアイコンをクリック
   - 「新しいスプレッドシートを作成」を選択
   - スプレッドシート名: `VBA Dev Hub - お問い合わせ回答`
   - 「作成」をクリック

3. **メール通知を設定**（オプション）
   - スプレッドシートが開いたら、「ツール」→「通知ルール」を選択
   - 「ユーザーがフォームを送信したとき」を選択
   - 通知方法: メール - すぐに通知
   - 「保存」をクリック

## ✅ 確認事項

設定完了後、以下を確認してください：

- [ ] フォームが正しく埋め込まれている
- [ ] すべての質問が表示されている
- [ ] 必須項目が機能している
- [ ] メールアドレスの検証が機能している
- [ ] 送信後の確認メッセージが表示される
- [ ] 回答がスプレッドシートに保存される
- [ ] メール通知が届く（設定した場合）

## 🎨 推奨設定

### フォームのテーマ

VBA Dev Hubのデザインに合わせて、以下の設定を推奨します：

- **テーマの色**: 紫色（#9333EA）
- **背景色**: 白
- **フォントスタイル**: Basic

### 確認メッセージ

```
お問い合わせありがとうございます。

ご入力いただいた内容を確認し、通常2〜3営業日以内にご返信いたします。
お急ぎの場合は、件名に「至急」とご記入ください。

VBA Dev Hub 運営チーム
```

## 📊 回答の管理

### スプレッドシートの列

Googleスプレッドシートには、以下の列が自動的に作成されます：

1. **タイムスタンプ**: 送信日時
2. **お名前**: 回答者の名前
3. **メールアドレス**: 回答者のメールアドレス
4. **件名**: 選択された件名
5. **お問い合わせ内容**: 問い合わせの詳細

### 回答の整理

スプレッドシートで以下の操作が可能です：

- **フィルタ**: 件名別に絞り込み
- **並び替え**: タイムスタンプで並び替え
- **ラベル**: 対応状況を追加（例：未対応、対応中、完了）
- **メモ**: 対応内容を記録

### 回答の分析

Googleフォームの「回答」タブでは、以下の情報が確認できます：

- 回答数の推移
- 件名別の集計
- 回答の詳細

## 🔒 セキュリティとプライバシー

### 個人情報の取り扱い

- 回答者の個人情報（名前、メールアドレス）は、お問い合わせ対応のみに使用
- 第三者への提供は行わない
- 不要になった情報は適切に削除

### アクセス権限

- Googleフォームとスプレッドシートのアクセス権限は、運営チームのみに制限
- 共有設定で「リンクを知っている全員」を「制限付き」に変更

## 🛠️ トラブルシューティング

### フォームが表示されない

**原因**: URLが正しく設定されていない

**解決方法**:
1. `app/contact/page.tsx`の`GOOGLE_FORM_URL`を確認
2. URLに`YOUR_FORM_ID`が残っていないか確認
3. URLが`https://docs.google.com/forms/d/e/...`で始まっているか確認

### フォームが小さく表示される

**原因**: iframeのサイズ設定

**解決方法**:
- `app/contact/page.tsx`の`height="800"`を調整
- フォームの質問数に応じて、800〜1200の範囲で調整

### 回答が届かない

**原因**: スプレッドシートのリンクが切れている

**解決方法**:
1. Googleフォームの「回答」タブを開く
2. スプレッドシートアイコンをクリック
3. 既存のスプレッドシートを選択または新規作成

### メール通知が届かない

**原因**: 通知ルールが設定されていない

**解決方法**:
1. スプレッドシートを開く
2. 「ツール」→「通知ルール」を選択
3. 「ユーザーがフォームを送信したとき」を設定

## 📝 メンテナンス

### 定期的な確認

- **週1回**: 回答の確認と対応
- **月1回**: スプレッドシートの整理
- **四半期ごと**: フォームの質問内容の見直し

### バックアップ

- スプレッドシートを定期的にダウンロード（CSV形式）
- Googleドライブの容量を確認

## 💡 応用例

### 自動返信の設定

Googleフォームのアドオン「Email Notifications for Google Forms」を使用すると、回答者に自動返信メールを送信できます。

### カスタムドメインの使用

Google Workspaceを使用している場合、カスタムドメインのメールアドレスで通知を受け取ることができます。

### APIとの連携

Google Forms APIを使用すると、回答をプログラムで取得・処理できます。

## 🎯 まとめ

Googleフォームを使用することで、以下のメリットがあります：

✅ **無料**: Googleアカウントがあれば無料で使用可能  
✅ **簡単**: プログラミング不要で設定可能  
✅ **自動保存**: 回答が自動的にスプレッドシートに保存  
✅ **メール通知**: 新しい回答があるとメールで通知  
✅ **モバイル対応**: スマートフォンからも回答可能  
✅ **スパム対策**: Googleの自動スパム検出機能

---

**作成日**: 2025年11月22日  
**対象**: VBA Dev Hub 運営チーム  
**ステータス**: 実装準備完了
